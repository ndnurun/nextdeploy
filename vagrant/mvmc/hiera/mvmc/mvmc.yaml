---

classes:
  - roles::mvmc

mysql_db:
  s_mvmc:
    user: s_mvmc
    password: s_mvmc
    host: '%'
    grant: 'all'

mysql::server::root_password: 'toor'
mysql::server::override_options:
  mysqld_safe:
    log_error: /var/log/mysql/mysql.err
  mysqld:
    bind_address: 0.0.0.0
    datadir: /var/lib/mysql
    skip-external-locking: true

# jenkins parametes
jenkins::port: 9292
#jenkins::repo: false

# gitlab parameters
gitlab::ensure: installed
gitlab::gitlab_http_port: '8181'
gitlab::gitlab_ssl_port: '8282'
gitlab::external_url: "http://%{hiera('global::gitlaburi')}"
gitlab::gitlab_rails:
  time_zone: 'UTC'
  gitlab_default_theme: 4
  gitlab_email_display_name: 'Gitlab'
gitlab::sidekiq:
  shutdown_timeout: 5

vpnserver:
  mvmc:
    country: FR
    province: IDF
    city: Paris
    organization: os.mvmc
    email: usera@os.mvmc
    server: '10.0.171.0 255.255.255.0'
    push:
      - "%{hiera('global::pubprefix')}.0 255.255.255.0"

rvm::system_rubies:
  '2.1.0':
    default_use: true

rvm::system_users:
  - modem

rvm::gem:
  bundler:
    name: 'bundler'
    ruby_version: 'ruby-2.1.0'
    ensure: 'latest'
  rake:
    name: 'rake'
    ruby_version: 'ruby-2.1.0'
    ensure: '10.4.2'

is_cron: "yes"
cron_cmd:
  puppetsign:
    command: "puppet cert sign --all"
    user:  "root"
    minute: '*/2'
    hour: '*'
    weekday: '*'
  rdnsmasq:
    command: "/root/./rdnsmasq.sh"
    user: 'root'
    minute: '*'
    hour: '*'
    weekday: '*'
  puma:
    command: 'cd /home/modem && ./puma.sh'
    user: 'modem'
    minute: '*/2'
    hour: '*'
    weekday: '*'
  emberbuild:
    command: '/home/modem/./ember.sh'
    user: 'modem'
    minute: '*'
    hour: '*'
    weekday: '*'
